---
title: "EDA"
author: "Matty Pahren"
date: "9/24/2020"
output: pdf_document
---

```{r}
library(tidyverse)

```

```{r}
data <- readRDS("final_data.Rds")
raw_data <- readRDS("chest_and_wrist.Rds")
```



```{r temp-plots-raw}
ggplot(raw_data, aes(x = X1, y = Temp, color = Participant)) + geom_point()
ggplot(raw_data, aes(x = X1, y = TEMP_wrist, color = Participant)) + geom_point()

ggplot(raw_data, aes(x = Temp)) + facet_wrap(~Participant) + geom_histogram()
ggplot(raw_data, aes(x = TEMP_wrist)) + facet_wrap(~Participant) + geom_histogram()
```

```{r temp-plots-transformed}
ggplot(data, aes(mean_Temp_chest)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(mean_Temp_wrist)) + facet_wrap(~participant) + geom_histogram()

ggplot(data, aes(sd_Temp_chest)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(sd_Temp_wrist)) + facet_wrap(~participant) + geom_histogram()

ggplot(data, aes(range_Temp_chest)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(range_Temp_wrist)) + facet_wrap(~participant) + geom_histogram()
```


```{r resp-plots-raw}
ggplot(raw_data, aes(x = X1, y = Resp, color = Participant)) + geom_point()
ggplot(raw_data, aes(x = Resp)) + facet_wrap(~Participant) + geom_histogram()
```


```{r resp-plots-transformed}
ggplot(data, aes(mean_inhale)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(mean_exhale)) + facet_wrap(~participant) + geom_histogram()

ggplot(data, aes(sd_inhale)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(sd_exhale)) + facet_wrap(~participant) + geom_histogram()

ggplot(data, aes(range_resp)) + facet_wrap(~participant) + geom_histogram()

ggplot(data, aes(mean_breath)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(sd_breath)) + facet_wrap(~participant) + geom_histogram()
ggplot(data, aes(range_breath)) + facet_wrap(~participant) + geom_histogram()

ggplot(data, aes(i_e_ratio)) + facet_wrap(~participant) + geom_histogram()
```

```{r transformed-EMG-EDA}
# EMG
raw_data %>% 
  mutate(row = row_number()) %>% 
  ggplot(aes(x = row, y = EMG, color = as.factor(Label))) + 
  geom_line() + 
  facet_wrap(Participant~. ,  scales = "free")


# chest EDA
raw_data %>% 
  mutate(row = row_number()) %>% 
  ggplot(aes(x = row, y = EDA, color = as.factor(Label))) + 
  geom_line() + 
  facet_wrap(Participant~. ,  scales = "free")

# wrist EDA
raw_data %>% 
  mutate(row = row_number()) %>% 
  ggplot(aes(x = row, y = EDA_wrist, color = as.factor(Label))) + 
  geom_line() + 
  facet_wrap(Participant~. ,  scales = "free")
```

```{r}
library(psych)
EDA_wrist_eng_df <- data %>% 
  select(participant, label, mean_EDA_wrist:range_EDA_wrist) 

EDA_chest_eng_df <- data %>% 
  select(participant, label, mean_EDA:range_EDA) 

EMG_chest_eng_df <- data %>% 
  select(participant, label, mean_EMG:range_EMG) 

pairs.panels(EDA_wrist_eng_df[,-c(1,2)], 
             method = "pearson", # correlation method
             hist.col = "#00AFBB",
             density = TRUE,  # show density plots
             
)
pairs.panels(EDA_chest_eng_df[,-c(1,2)], 
             method = "pearson", # correlation method
             hist.col = "#00AFBB",
             density = TRUE,  # show density plots
             
)
pairs.panels(EMG_chest_eng_df[,-c(1,2)], 
             method = "pearson", # correlation method
             hist.col = "#00AFBB",
             density = TRUE,  # show density plots
             
)
```



